provisioner: azure
name: sonatype-nexus-iq
version: 1
revision: 1
displayName: Sonatype nexus IQ
description: This template assumes that application zip is present at DefaultWorkingDirectory
target: ""
category: code analysis
keywords:
  - nexusIQ
  - sonatype
author: CloudCover
meta: {}
env:
  - CPI__NEXUS_SERVICE_CONNECTION
  - CPI__NEXUS_ORG_ID
inputs:
  properties:
    nexus_application_id:
      title: NexusIQ Application ID
      description: NexusIQ application id
      type: string
      default: ""
    pool_name:
      title: Pool Name
      description: Use selfhosted agent by proving agent pool name.
      type: string
      default: ""
    applicationName:
      title: Application name
      description: Code Pipes application name
      type: string
  internal:
    - applicationName
template: |
  steps:
    - task: NexusIqPipelineTask@1
      inputs:
        nexusIqService: $(CPI__NEXUS_SERVICE_CONNECTION)
        organizationId: $(CPI__NEXUS_ORG_ID)
        applicationId: {% if nexus_application_id %} {{ nexus_application_id }}{% else %}{{ applicationName }}{% endif %}
        stage: 'Build'
        scanTargets: $(System.DefaultWorkingDirectory)/{{applicationName}}.zip